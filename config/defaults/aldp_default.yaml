device: 'cuda'

method: 'FM'

target:
  name: "aldp"
  dim: 66
  aldp1:
    env: implicit
    lambd: 0.0
    n_dim: 3
    n_particles: 22
    n_threads: 8
    sample_path: data/aldp_0.0_align.pt
    scaling: 20.0
    score_path: data/aldp_0.0_align_grad.pkl
    temperature: 300
  aldp2:
    env: implicit
    lambd: 1.0
    n_dim: 3
    n_particles: 22
    n_threads: 8
    sample_path: data/aldp_1_align.pt
    scaling: 20.0
    score_path: data/aldp_1_align_grad.pkl
    temperature: 300

network:
  name: 'egnn'
  learn_b: true
  score_net:
    num_layer: 4
    num_hid: 64
    clip: 10000
  vector_field:
    num_layer: 4
    num_hid: 64
    clip: 10000
  cutoff: null

coef:
  alpha: '1-t'
  beta: 't'
  gamma: 'sqrt(a*t*(1-t))+b'
  b: 0
  a: 0.05
  eps: 0.01

train:
  lr: 0.001
  num_epoch: 100000
  batch_size: 500
  OT_pair: true
  ema_rate: 0.995
  
  finetune: false

sample:
  num_step: 500
  
save:
  save_dir: "results"
  eval_gap: 1000
  eval_sample: 50
  eval_batch: 25
  eval_div: true 